---
title: "Pseudoreplication"
author: "NRES 710"
date: "Last compiled: `r Sys.Date()`"
output:
  html_document:
    theme: yeti
    toc: yes
    toc_float: yes
    css: styles.css
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = FALSE,
	cache = TRUE
	)
```

```{r echo=FALSE}

#  NRES 710, Pseudoreplication
#     University of Nevada, Reno
#     Discussion of Hurlbert 1984

```

So I asked you all to read Hurlbert 1984, a classic paper in ecology and experimental design. This paper has been cited >10,000 times. I read it in all of my graduate school statistics class, and I believe it remains necessary to introduce you all to this paper and concept further in this class as well.

Let's start with where I told you all to start on page 198 at the 'Pseudoreplication in Manipulative Experiments'

## Four Types of Pseudoreplication

1. Simple pseudoreplication

The first type of pseudoreplication discussed by Hurlbert was '**simple pseudoreplication**'.

To illustrate this, Hurlbert discussed an example where a field was split in half into two large sub-fields, and the experimenters wanted to test if there was an effect of herbicide on beetle density.

*Brian draw one large square field; split it into half, treatment and control; indicate pseudoreplicate samples within each subfield*

![](lecture_20_simple_pseudoreplication.png){width=80%}

These 'replicates' within each subfield are **not true replicates**, because the *treatment is being applied to the entire subfield*.

The problem is that: (1) two sub-fields will always be different from eachother. Any two points in space in the universe are different from eachother, and if we collect enough data a test will say those two points are statistically different. (2) If we do this 'experiment', we don't know whether the results are significant due to experimental treatment OR the two subfields simply being different from eachother. 

**What is the treatment being applied to:** only one sample is treated, one sample controlled.

**Sometimes we have to do this.** If we want to perform a large-scale manipulative experiment of feral pig density, for example, we may be constrained by only two locations where we can (1) reduce pig density, or (2) leave pigs unmanaged. In this case, we know that we cannot do statistics comparing response variables between managed and unmanaged areas. And this is what Hurlbert recommends at the end: if you commit this 'simple pseudoreplication', be honest about the limitations of your design and communicate the results clearly.

This is still common. One student I spoke to this year had a design that was identical to this. They were constrained by the biological system they were studying with large animals that are difficult to manipulate. It vastly limits the scope of inference

<br>

## Truth

Here is the code to create Truth for the two datasets analyzed here today.

```{r}
################### 'Truth' #################### 
### Lecture 19: code to simulate data for class

### Dataset 1
# Simulate split-plot design data w/ three fixed effects: bison, fertilizer, water split across 6 fields
set.seed(123)

# Fields
n_fields <- 6
n_bison <- 2
n_fertilizer <- 2
n_water <- 3
Field <- sort(rep(rep(1:n_fields, n_bison*n_fertilizer*n_water)))

# Bison
Bison <- rep(sort(rep(c(0, 1), n_fertilizer*n_water)), n_fields)

# Fertilizer
Fertilizer <- rep(sort(rep(c(0, 1), n_water)), n_fields)

# Water
Water <- rep(c("Low", "Medium", "High"), n_fields * n_bison * n_fertilizer)
Water <- factor(Water, levels = c("Low", "Medium", "High"))
dummy <- data.frame(model.matrix(~ Water - 1))

# Field error
FieldError <- rep(rnorm(n_fields, 0, 1), each = n_bison * n_fertilizer * n_water)

# Bison error
BisonError <- rep(rnorm(n_bison * n_fields, 0, 2), each = n_fertilizer * n_water)

# Fertilizer error
FertilizerError <- rep(rnorm(n_fertilizer * n_bison * n_fields, 0, 2), each = n_water)

# Residual error
Error <- rnorm(length(Field), 0, 1)

# Response variable -- biomass
Biomass <- 20 + 10*Bison + 10*Fertilizer + 10*dummy$WaterMedium + 10*dummy$WaterHigh + FieldError + BisonError + FertilizerError + Error

# Save the data
datum <- data.frame(Field = Field, Bison = Bison, Fertilizer = Fertilizer, Water = Water, WaterMed = dummy$WaterMedium, WaterHigh = dummy$WaterHigh, FieldError = FieldError, BisonError = BisonError, FertError = FertilizerError, Error = Error, Biomass = Biomass)

# Save the data
write.csv(datum, "lecture_20_dataset1.csv", row.names = FALSE)


```

[--go to next lecture--](lecture_21.html)
