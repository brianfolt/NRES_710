<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="NRES 710" />


<title>Chi-squared tests</title>

<script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">NRES 710</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="schedule.html">Schedule</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="INTRO.html">Introduction to NRES 710</a>
    </li>
    <li>
      <a href="LECTURE1.html">Basic Concepts</a>
    </li>
    <li>
      <a href="LECTURE2.html">Sampling uncertainty</a>
    </li>
    <li>
      <a href="LECTURE3.html">Taxonomy of common statistics</a>
    </li>
    <li>
      <a href="LECTURE4.html">t-test and z-test</a>
    </li>
    <li>
      <a href="LECTURE5.html">chi-squared tests</a>
    </li>
    <li>
      <a href="LECTURE6.html">Linear Regression</a>
    </li>
    <li>
      <a href="LECTURE7.html">ANOVA</a>
    </li>
    <li>
      <a href="LECTURE8.html">GLM and GLMM</a>
    </li>
    <li>
      <a href="LECTURE9.html">Next steps</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Exercises
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="EXERCISE1.html">Exercise- data summary functions</a>
    </li>
    <li>
      <a href="EXERCISE2.html">Exercise- t-tests</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    More Resources
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Links.html">Links</a>
    </li>
    <li>
      <a href="FINALPROJ.html">Final Projects</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Datasets
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Data1.dat">Data1</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Chi-squared tests</h1>
<h4 class="author">NRES 710</h4>
<h4 class="date">Fall 2022</h4>

</div>


<div id="download-the-r-code-for-this-lecture" class="section level2">
<h2>Download the R code for this lecture!</h2>
<p>To follow along with the R-based lessons and demos, <a
href="LECTURE5.R">right (or command) click on this link and save the
script to your working directory</a></p>
</div>
<div id="overview-chi-squared-tests" class="section level2">
<h2>Overview: Chi-squared-tests</h2>
<div id="assumptions-of-chi-squared-tests" class="section level3">
<h3>Assumptions of Chi-squared tests</h3>
<ul>
<li>Response variable (and predictor variable, for test for
independence) must be <em>categorical</em> (data can be summarized as
<strong>contingency table</strong>)<br />
</li>
<li>Samples must be independent (this is almost always an assumption of
our classical statistical tests)<br />
</li>
<li>Samples must be representative of the population of interest (again,
this is always a key assumption)<br />
</li>
<li>There must be a sufficient sample size such that the <em>expected
number of observations</em> in each element of the contingency table is
at least 5!</li>
</ul>
<div id="the-chi-squared-statistic" class="section level4">
<h4>The Chi-squared statistic:</h4>
<p><span class="math inline">\(\chi^2 =
\sum_{i=1}^k\frac{(x_i-exp_i)^2}{exp_i}\)</span></p>
<p>Here, <span class="math inline">\(exp_i\)</span> is the expected
number of observations (count) in category i (e.g., under the null
hypothesis). <span class="math inline">\(x_i\)</span> is the observed
number/count in category i. So the Chi-squared statistic basically
summarizes the degree to which the observed count disagrees with the
expected count across all categories.</p>
<p>Why is the numerator squared? First, this makes all deviations
positive- negatives and positives can’t cancel each other out. Second,
it allows us to use the well-described Chi-squared distribution!</p>
</div>
<div id="the-chi-squared-distribution" class="section level4">
<h4>The Chi-squared distribution</h4>
<p>The Chi-squared distribution is described (like the <em>t</em>
distribution) by a certain degrees of freedom (‘degrees of freedom’ is
the <em>parameter</em> needed to describe the distribution – just like
mean and standard deviation are parameters of the normal
distribution).</p>
<p>If you are performing a goodness-of-fit test, the degrees of freedom
for this test is one less than the number of categories.</p>
<p>If you are performing a test for independence of two categorical
variables, the degrees of freedom is computed as <span
class="math inline">\((r-1)(c-1)\)</span> where r and c are the number
of categories in each of the two categorical variables,
respectively.</p>
</div>
</div>
<div id="chi-square-goodness-of-fit-test." class="section level3">
<h3>Chi-square goodness-of-fit test.</h3>
<p>This test asks the question “do the observations sort into categories
according to your (null) hypothesis?” In a Chi-square goodness-of-fit
test, the response variable of interest is categorical. Like the
one-sample t-test, there is no predictor variable.</p>
<p><em>Example</em>: Are graduate students more likely to be born some
months versus other months?</p>
<p>What is the population? sample? parameter? statistic?</p>
<p>In this example, the response variable of interest is the birth
month- which is best considered a categorical variable. You can run this
test on non-categorical variables (e.g., continuous numeric), but you
have to turn your variable into a categorical variable (e.g., by
“binning”) prior to conducting this analysis.</p>
<div id="example-in-r" class="section level4">
<h4>Example in R</h4>
<pre class="r"><code>## Chi squared goodness-of-fit example

birthdays.bymonth &lt;- c(40,23,33,39,28,29,45,31,22,34,44,20)
months &lt;- c(&quot;Jan&quot;,&quot;Feb&quot;,&quot;Mar&quot;,&quot;Apr&quot;,&quot;May&quot;,&quot;Jun&quot;,&quot;Jul&quot;,&quot;Aug&quot;,&quot;Sep&quot;,&quot;Oct&quot;,&quot;Nov&quot;,&quot;Dec&quot;)
names(birthdays.bymonth) &lt;- months

sample.size &lt;- sum(birthdays.bymonth)
k = length(birthdays.bymonth)   # number of categories (months)
exp.birthdays.bymonth &lt;- sample.size*rep(1/k,times=k)   # compute the expected number under the null hypothesis.

Chisq.stat &lt;- sum((birthdays.bymonth-exp.birthdays.bymonth)^2/exp.birthdays.bymonth)
Chisq.stat</code></pre>
<pre><code>## [1] 24.14433</code></pre>
<pre class="r"><code>## View the summary statistic along with its sampling distribution under the null hypothesis

curve(dchisq(x,k-1),0,75)
abline(v=Chisq.stat,col=&quot;green&quot;,lwd=3)</code></pre>
<p><img src="LECTURE5_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<pre class="r"><code>p &lt;- 1-pchisq(Chisq.stat,k-1)
p</code></pre>
<pre><code>## [1] 0.01213825</code></pre>
<pre class="r"><code>### use R&#39;s built in chi squared function

chisq.test(birthdays.bymonth)     # should get the same p value!</code></pre>
<pre><code>## 
##  Chi-squared test for given probabilities
## 
## data:  birthdays.bymonth
## X-squared = 24.144, df = 11, p-value = 0.01214</code></pre>
<p>Here is another example- this time we use a Chi-squared goodness of
fit test to assess normality of a continuous variable. This example is
meant to enhance understanding of the chi-squared goodness of fit test–
I don’t suggest running this test to assess normality, since the
shipiro-wilks test is a better test!</p>
<pre class="r"><code># Chi-squared test for normality

normal.data &lt;- rnorm(250,4,1.5)  # generate normal data
nonnormal.data &lt;-  runif(250,2,6)  # generate non-normal data

hist(normal.data)</code></pre>
<p><img src="LECTURE5_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<pre class="r"><code>hist(nonnormal.data)</code></pre>
<p><img src="LECTURE5_files/figure-html/unnamed-chunk-3-2.png" width="672" /></p>
<pre class="r"><code># First bin the data (chi squared test must be on categorical data!)

breaks &lt;- c(-Inf,1,2,3,3.5,4,4.5,5,6,7,Inf)

normal.data.binned &lt;- cut(normal.data,breaks,labels=breaks[-1])
nonnormal.data.binned &lt;- cut(nonnormal.data,breaks,labels=breaks[-1])

obs_table_norm &lt;- table(normal.data.binned)
obs_table_nonnorm &lt;- table(nonnormal.data.binned)

# Determine expected values in each cell if the underlying distribution were normal

normal.probs &lt;- sapply(2:length(breaks), function(t) pnorm(breaks[t],mean(normal.data),sd(normal.data))-pnorm(breaks[t-1],mean(normal.data),sd(normal.data))  )
exp_table_norm &lt;- length(normal.data)*normal.probs  # check that expected vals are greater than 5

normal.probs &lt;- sapply(2:length(breaks), function(t) pnorm(breaks[t],mean(nonnormal.data),sd(nonnormal.data))-pnorm(breaks[t-1],mean(nonnormal.data),sd(nonnormal.data))  )
exp_table_nonnorm &lt;- length(normal.data)*normal.probs  # check that expected vals are greater than 5

# Chi squared stat for normality test on normal data

chistat_norm &lt;- sum((obs_table_norm-exp_table_norm)^2/exp_table_norm)
pval_norm &lt;- 1-pchisq(chistat_norm,length(exp_table_norm)-1)
pval_norm</code></pre>
<pre><code>## [1] 0.1633256</code></pre>
<pre class="r"><code>chistat_nonnorm &lt;- sum((obs_table_nonnorm-exp_table_nonnorm)^2/exp_table_nonnorm)
pval_nonnorm &lt;- 1-pchisq(chistat_nonnorm,length(exp_table_nonnorm)-1)
pval_nonnorm</code></pre>
<pre><code>## [1] 1.785932e-09</code></pre>
<pre class="r"><code># Compare with shapiro wilk test (which is a MUCH better test!)

shapiro.test(normal.data)</code></pre>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  normal.data
## W = 0.9955, p-value = 0.6817</code></pre>
<pre class="r"><code>shapiro.test(nonnormal.data)</code></pre>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  nonnormal.data
## W = 0.94983, p-value = 1.392e-07</code></pre>
</div>
</div>
<div id="chi-square-test-for-independence" class="section level3">
<h3>Chi-square test for independence</h3>
<p>In the chi-square test for independence, we are testing for a
relationship between two categorical variables. That is, both your
response variable and predictor variables are categorical. For example,
we might test if rabbit ear type (floppy, pointy, mixed) is associated
with rabbit coat color (white, brown, mixed) (e.g., are floppy eared
rabbits more likely to be white than bunnies with pointy ears).</p>
<div id="example-in-r-1" class="section level4">
<h4>Example in R</h4>
<p>Here we are testing if bunnies ear type is related to coat color.
First we summarize the number of bunnies with each possible combination
of coat color and ear type (this is our contingency table). Then we
determine what number would be expected in each category if the null
hypothesis were true. Finally we can compute the chi-squared statistic
and compare with the null sampling distribution (chi squared
distribution). Here is the code:</p>
<pre class="r"><code>n.bunnies &lt;- 112

    # sample assuming null hypothesis is true
all.bunnies &lt;- data.frame(
  ear_type = sample(c(&quot;floppy&quot;,&quot;pointy&quot;,&quot;mixed&quot;),n.bunnies,replace = T),
  coat_color = sample(c(&quot;white&quot;,&quot;brown&quot;,&quot;mixed&quot;),n.bunnies,replace = T)
)

head(all.bunnies)</code></pre>
<pre><code>##   ear_type coat_color
## 1   floppy      mixed
## 2   pointy      brown
## 3   pointy      brown
## 4   pointy      mixed
## 5   pointy      brown
## 6   floppy      mixed</code></pre>
<pre class="r"><code># make contingency table

con_table &lt;- table(all.bunnies$ear_type,all.bunnies$coat_color)

# generate expected values

prop.ears &lt;- rowSums(con_table)/n.bunnies
sum.coats &lt;- colSums(con_table)
exp_table &lt;- sapply(1:ncol(con_table),function(t) sum.coats[t]*prop.ears)
colnames(exp_table) &lt;- colnames(con_table)

# compute chi-squared statistic

Chisq.stat &lt;- sum((con_table-exp_table)^2/exp_table)


# Compare chi squared statistic with null sampling distribution

curve(dchisq(x,4),0,10)
abline(v=Chisq.stat,col=&quot;blue&quot;,lwd=2)

p.value &lt;- 1-pchisq(Chisq.stat,4)
p.value</code></pre>
<pre><code>## [1] 0.08196423</code></pre>
<pre class="r"><code>text(7,0.15,paste0(&quot;p = &quot;,round(p.value,3)))</code></pre>
<p><img src="LECTURE5_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code># Compare with R&#39;s built in chi squared function

chisq.test(con_table)</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  con_table
## X-squared = 8.2763, df = 4, p-value = 0.08196</code></pre>
</div>
</div>
</div>
<div id="g-test" class="section level2">
<h2>G test</h2>
<p>Many statistical tests recommend the G test as an alternative to the
Pearson Chi-squared test. The test is very similar to the Chi Squared
test, and has the same number of degrees of freedom. The G statistic is
computed as:</p>
<p><span class="math inline">\(G = 2\cdot \sum{O_i\cdot
ln(\frac{O_i}{E_i})}\)</span></p>
<p>The sampling distribution for the G statistic is, for large sample
sizes, approximately Chi-squared distributed with the same number of
degrees of freedom as for the corresponding Chi-squared test.</p>
<p>Let’s repeat the bunny example above, this time using both the
Chi-squared test and the G test.</p>
<pre class="r"><code>n.bunnies &lt;- 112

    # sample assuming null hypothesis is true
all.bunnies &lt;- data.frame(
  ear_type = sample(c(&quot;floppy&quot;,&quot;pointy&quot;,&quot;mixed&quot;),n.bunnies,replace = T),
  coat_color = sample(c(&quot;white&quot;,&quot;brown&quot;,&quot;mixed&quot;),n.bunnies,replace = T)
)

head(all.bunnies)</code></pre>
<pre><code>##   ear_type coat_color
## 1    mixed      mixed
## 2    mixed      brown
## 3    mixed      white
## 4    mixed      white
## 5    mixed      mixed
## 6   pointy      white</code></pre>
<pre class="r"><code># make contingency table

con_table &lt;- table(all.bunnies$ear_type,all.bunnies$coat_color)

# generate expected values

prop.ears &lt;- rowSums(con_table)/n.bunnies
sum.coats &lt;- colSums(con_table)
exp_table &lt;- sapply(1:ncol(con_table),function(t) sum.coats[t]*prop.ears)
colnames(exp_table) &lt;- colnames(con_table)

# compute chi-squared and G statistics

Chisq.stat &lt;- sum((con_table-exp_table)^2/exp_table)
G.stat &lt;- 2*sum(con_table*log(con_table/exp_table))   # slightly different!


# Compare chi squared and G statistics with null sampling distribution

curve(dchisq(x,4),0,10)
abline(v=Chisq.stat,col=&quot;blue&quot;,lwd=1)
abline(v=G.stat,col=&quot;red&quot;,lwd=1)
legend(&quot;topright&quot;,lty=c(1,1),lwd=c(1,1),col=c(&quot;blue&quot;,&quot;red&quot;),legend=c(&quot;Chi-squared&quot;,&quot;G stat&quot;),bty=&quot;n&quot;)

p.value.Chi &lt;- 1-pchisq(Chisq.stat,4)
p.value.G &lt;- 1-pchisq(G.stat,4)

text(7,0.12,paste0(&quot;p.Chi = &quot;,round(p.value.Chi,3)))
text(7,0.1,paste0(&quot;p.G = &quot;,round(p.value.G,3)))</code></pre>
<p><img src="LECTURE5_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>As you can see, in practice it won’t usually matter whether you use
the Chi-squared or G statistic! But some reviewers may ask you to use
the G statistic because most statisticians agree that it does a slightly
better job than the classical Chi-squared statistic.</p>
</div>
<div id="non-parametric-alternatives" class="section level2">
<h2>Non-parametric alternatives</h2>
<p>The Chi-squared test is sometimes considered a non-parametric test
because it does not assume anything about the underlying distribution of
the data or the residuals. The Chi-squared tests simply makes the
assumption that the observations are independent. Given the independence
of observations AND large enough sample size, the sampling distribution
for the chi-squared statistic (and G statistic) should be distributed
according to a chi-squared distribution with the appropriate degrees of
freedom.</p>
<p>BUT… the Fisher exact test makes fewer assumptions than the
Chi-squared test– namely that the sample size is ‘large enough’ and
should be used in place of the Chi-squared test when you have small
sample size. Here is the bunny example again, this time with small
sample size:</p>
<pre class="r"><code>n.bunnies &lt;- 20

    # sample assuming null hypothesis is true
all.bunnies &lt;- data.frame(
  ear_type = sample(c(&quot;floppy&quot;,&quot;pointy&quot;,&quot;mixed&quot;),n.bunnies,replace = T),
  coat_color = sample(c(&quot;white&quot;,&quot;brown&quot;,&quot;mixed&quot;),n.bunnies,replace = T)
)

head(all.bunnies)</code></pre>
<pre><code>##   ear_type coat_color
## 1   pointy      mixed
## 2   pointy      brown
## 3   floppy      brown
## 4   pointy      brown
## 5    mixed      mixed
## 6   pointy      white</code></pre>
<pre class="r"><code># make contingency table

con_table &lt;- table(all.bunnies$ear_type,all.bunnies$coat_color)

# generate expected values

prop.ears &lt;- rowSums(con_table)/n.bunnies
sum.coats &lt;- colSums(con_table)
exp_table &lt;- sapply(1:ncol(con_table),function(t) sum.coats[t]*prop.ears)
colnames(exp_table) &lt;- colnames(con_table)

# run fisher exact test

#?fisher.test

chisq.test(con_table)</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  con_table
## X-squared = 4.3333, df = 4, p-value = 0.3628</code></pre>
<pre class="r"><code>fisher.test(con_table)   # better test</code></pre>
<pre><code>## 
##  Fisher&#39;s Exact Test for Count Data
## 
## data:  con_table
## p-value = 0.4312
## alternative hypothesis: two.sided</code></pre>
<pre class="r"><code>fisher.test(con_table,simulate.p.value = T,B=5000)   # use simulated p-value - usually very similar answer</code></pre>
<pre><code>## 
##  Fisher&#39;s Exact Test for Count Data with simulated p-value (based on
##  5000 replicates)
## 
## data:  con_table
## p-value = 0.4323
## alternative hypothesis: two.sided</code></pre>
<p><a href="LECTURE6.html">–go to next lecture–</a></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
