

# Let's pretend there are 500 ponds in the Sierra Nevada. 
# How many frogs are in those ponds?  Population! 

ylpop<-rnbinom(500, 4, .6)

hist(ylpop, 
     col='lightblue', 
     xlab="Number of frogs per pond", 
     ylab="Number of ponds", 
     main="")


# Now, let's sample some means! 

install.packages("simpleboot")
library(simpleboot)

ylmean<-one.boot(ylpop, mean,R=1000)
hist(ylmean, col="lightblue",
     xlab="mean")

# what happens to the distribution? 

#what if we sampled only 10? 

ylmean2<-one.boot(ylpop, mean, R=10)
hist(ylmean2, col="lightblue",
     xlab="mean")
# we are still close to the actual mean! 

# how unlikely would it be to get a mean population estimate of say... 8? 


#### This is where it was wrong in class - DON'T USE!!! 
# dnbinom(8, 4,0.6) # returns probability of observing 8, given the distribution characteristics above
# 0.01 - or 1% of the time! That's unlikely - and unlucky!! 

#### This is the way to proceed: First we have to look at what the object "ylmean" actually is. 
# It's a list with a bunch of objects within it. What we want are the 1000 means - that's ylmean$t. 
str(ylmean)

# now - compute the overall mean and standard deviation of this normally distributed set of numbers. 
mean(ylmean$t)
sd(ylmean$t)

# next, use the NORMAL distrubtion to calculate the odds of getting a value of 8. 
pnorm(8, mean=2.513482, sd=0.09107104)
pnorm(2.8, mean=2.513482, sd=0.09107104)
pnorm(2.55, mean=2.513482, sd=0.09107104)


