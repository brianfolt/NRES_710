#### Moniz - Homework 3 - Linear Regression ####

# Dataset (2 columns, ~30 rows)

# how snake speed (cm/s) changes with increasing snout-vent-length (cm)
racedata <- data.frame("speed" = sample(x = 75:100, size = 30, replace = TRUE),
                       "SVL" = sample(x = 30:50, size = 30, replace = TRUE))

# intially used rnorm to create dataset, but felt that wasn't getting at the purpose of this assignment so switched to sample which I haven't used before, and is hopefully approriate.


racedata


# First 5 data points - Calculate slope, y-intercept, R value by hand
# speed     SVL
#  83        49
#  77        41
#  91        47
#  76        46
#  90        37

shortspd <- c(83, 77, 91, 76, 90)
shortsvl <- c(49, 41, 47, 46, 37)
shortdat <- data.frame(shortspd, shortsvl)

shortlm <- lm(shortspd~shortsvl)
summary(shortlm)

# checking my homework because my hand-calculation resulted in an r value outside of 0-1, but I checked it against the excel sheet that I created during the example we ran in-class and can't figure out what I did wrong.

# Turns out, what I did wrong was reading! r falls between -1 and 1, and it's r^2 that falls between 0 and 1.


# Linear regression on full dataset

attach(racedata)
racelm <- lm(speed~SVL)
summary(racelm)

plot(racelm)


#### Questions ####

# 1. Does the model fit the data well? Why?

# By taking the square of the r^2 value in summary(racelm), we find that r = 0.48 which I believe is a fairly good correlation for ecological data, leading me to believe that this model does fit the data fairly well. However, looking at the Residuals vs. Fitted plot for racelm, my data are pretty scattered around the grey midline, which suggests there might be a different pattern. None are ridiculously faraway from the midline, but there is a cloud towards the right that tails off to the left.

# 2. Do you think the data are normally distributed? What evidence did you use to make this inference?

# Again, the Resid. vs. Fitted plot starts to suggest that maybe a linear model is not the best fit for this data, which might be due to an underlying non-normal distribution. Investigating further with the Q-Q plot, there is an s-shaped pattern with the data bouncing toward and away from the midline. The ends don't aggressively tail away from the midline, however, so I want to check if I'm reading it correctly using some histograms.

hist(racedata$speed)
hist(racedata$SVL)
# neither are normally distributed, and would require transformation to correctly utilize a linear model.



# 3. Do you meet the assumption of homoscedasticity? What evidence do you have?

# The Scale-Location plot looks to be pretty clustered toward the right side of the plot, representing heteroscedastic data. The clustering is not insanely dominating, so I'm not sure if this is a situation in which we would truly be breaking the assumption of homoscedasticity, and would look for alternate statistical tools.


# 4. Do you have any outliers?

# The Residuals vs. Leverage plot shows that there are no extreme outliers, and not even many points getting close the point of needing further investigation, since they are away from all lines of Cook's Distance and clustering together. I would expect this, since my dataset was created around mean speeds with a limited range.



#### Plotting the Data ####

plot(racedata$speed ~ racedata$SVL, xlab = "Snout-Vent Length (cm)", ylab = "Sprint Speed (cm/s)", main = "Sprint Speed and Body Size in Thamnophis", pch = 20, col = "blue")

abline(racelm, lwd = 2)
legend("topright", legend = "r = 0.485, r^2 = 0.2354, p = 0.0065, 1 and 28 DF")

