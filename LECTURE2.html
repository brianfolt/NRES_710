<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="NRES 710" />


<title>t-tests</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 45px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h2 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h3 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h4 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h5 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h6 {
  padding-top: 50px;
  margin-top: -50px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">NRES 710</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="schedule.html">Schedule</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="INTRO.html">Introduction to NRES 710</a>
    </li>
    <li>
      <a href="LECTURE1.html">Basic Concepts</a>
    </li>
    <li>
      <a href="LECTURE2.html">Analysis- t test</a>
    </li>
    <li>
      <a href="LECTURE3.html">Analysis- chi2 test</a>
    </li>
    <li>
      <a href="LECTURE4.html">Analysis- linear regression</a>
    </li>
    <li>
      <a href="LECTURE5.html">Analysis- ANOVA</a>
    </li>
    <li>
      <a href="LECTURE6.html">Analysis- Multivariate</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    More Resources
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Links.html">Links</a>
    </li>
    <li>
      <a href="FINALPROJ.html">Final Projects</a>
    </li>
    <li>
      <a href="STUDYGUIDE.html">Study Guide</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">t-tests</h1>
<h4 class="author">NRES 710</h4>
<h4 class="date">Fall 2020</h4>

</div>


<div id="download-the-r-code-for-this-lecture" class="section level2">
<h2>Download the R code for this lecture!</h2>
<p>To follow along with the R-based lessons and demos, <a href="LECTURE2.R">right (or command) click on this link and save the script to your working directory</a></p>
</div>
<div id="overview-of-statistical-methods" class="section level2">
<h2>Overview of statistical methods</h2>
<p>Okay before we delve into t-tests, let’s first give a broad overview of the analyses we will cover in this class (at least a tiny bit) and in which cases they are most appropriate:</p>
<div id="continuous-response-variable" class="section level3">
<h3>Continuous response variable</h3>
<p>If your response variable is continuous (ratio, interval), common classical parametric statistical analyses include: t-tests, ANOVA, linear regression. Each of these tests is associated with non-parametric alternatives. In each case, we are interested in testing if the <em>population mean</em> of the continuous response variable is affected by the predictor variables (null hypothesis: nope, there is no effect!). Predictor variables, in turn, can be continuous or categorical (factor variables in R).</p>
<div id="continuous-response-categorical-predictor" class="section level4">
<h4>Continuous response, categorical predictor</h4>
<p>If your categorical predictor is binary (two levels), you can use a <strong>two-sample t-test</strong>. The non-parametric alternative is the <strong>Mann-Whitney test</strong>.</p>
<p>Example: Are females larger than males? (null hypothesis: no difference)</p>
<p>If your categorical predictor has more than two levels, you can use an <strong>ANalysis Of Variance (ANOVA)</strong> followed by <em>pairwise comparisons</em> to test which categories differ from one another. You can visualize these relationships with (e.g.) a boxplot. The non-parametric alternative is the <strong>Kruskal-Wallis test</strong>.</p>
</div>
<div id="continuous-response-continuous-predictor" class="section level4">
<h4>Continuous response, continuous predictor</h4>
<p>If your predictor variable is continuous, you can use <strong>linear regression</strong>. If you just want to know if two variables are correlated but you are not interested in modeling one (the response) as a function of another (the predictor) you can run a <strong>Pearson correlation test</strong>. The non-parametric alternative is a <strong>Spearman correlation test</strong>.</p>
<p>Example: What is the relationship between tree diameter and age- can tree diameter be used to effectively predict the age of a tree?</p>
</div>
<div id="continuous-response-both-continuous-and-categorical-predictors" class="section level4">
<h4>Continuous response, both continuous and categorical predictors</h4>
<p>In this case you can use <strong>Analysis of Covariance (ANCOVA)</strong> or just use <strong>multiple linear regression</strong>. In truth, linear regression and ANOVA are two sides of the same coin. You can run both analyses using the workhorse of linear modeling in R, the ‘lm’ function. Basically, if you have a continuous response variable, you can use the ‘lm’ function! The non-parametric alternative might be something like a <strong>regression tree</strong> analysis.</p>
</div>
</div>
<div id="discrete-count-response-variable" class="section level3">
<h3>Discrete (count) response variable</h3>
<p>With a discrete count response, you can use the same techniques as with a continuous response OR you can use <strong>generalized linear models</strong> with a Poisson error distribution (or other discrete probability distribution).</p>
</div>
<div id="categorical-response-variable" class="section level3">
<h3>Categorical response variable</h3>
<p>If your response variable is categorical (factor variable, ordinal variable, binary variable) then your choice of statistical methods changes:</p>
<div id="categorical-response-variable-categorical-predictor" class="section level4">
<h4>Categorical response variable, categorical predictor</h4>
<p>If both your response variable and your predictor variable are categorical, then you can use a <strong>chi-squared test</strong> or a <strong>Fisher exact test</strong> to test for an association between the two variables. You may first summarize your data as a <em>contingency table</em> like we did with the ‘lady tasting tea’ example.</p>
<p>Example: test for an association between salamander color morph (melanistic vs wild-type) and mating behavior (‘sneaker’ vs territory holder).</p>
</div>
<div id="categorical-response-variable-continuous-predictor" class="section level4">
<h4>Categorical response variable, continuous predictor</h4>
<p>If your response variable is binary (true/false, two levels) and your predictor variable is continuous, you can use <strong>logistic regression</strong> (which is a type of <em>generalized linear model</em>).</p>
<p>If your categorical response variable has more than two levels, you can use <strong>multinomial logistic regression</strong> (for categorical responses) or <strong>ordinal logistic regression</strong> (for ordinal responses).</p>
</div>
</div>
</div>
<div id="overview-t-tests" class="section level2">
<h2>Overview: t-tests</h2>
<p>Okay, now let’s move to the main topic of this lecture: t-tests! Here we have a continuous response variable and either no predictor variable (one sample t-test) or a binary predictor variable (two-sample t-test).</p>
<p>We have already performed simple versions of the t-test (one-sample t-tests). But t-tests are quite flexible and can be applied to a wide variety of null-hypothesis testing scenarios:</p>
<div id="one-sample-t-test" class="section level3">
<h3>One-sample t-test</h3>
<p>A one-sample t-test tests the consistency of the sample data with the null hypothesis that the sample was generated from a population with a specified mean (often zero, but not necessarily). As we have seen before, the t-statistic in this case is expressed as:</p>
<p><span class="math inline">\(t = \frac{(\bar{x}-\mu_0)}{s.e.}\)</span></p>
<p>Where <span class="math inline">\(\bar{x}\)</span> is the sample mean, <span class="math inline">\(s.e.\)</span> is the standard error of the mean, and <span class="math inline">\(\mu_0\)</span> is the population mean under the null hypothesis.</p>
<p>The t-statistic can be interpreted as the difference between the sample mean and the null population mean in units of standard errors.</p>
<p>Under the null hypothesis, the sampling distribution of the t-statistic should follow a t distribution with n-1 degrees of freedom.</p>
<pre class="r"><code>### one sample t-test (paired t-test is a type of one sample t-test)

sample.data &lt;- rgamma(10,2,.1)
null.mean &lt;- 10

sample.size &lt;- length(sample.data)
sample.mean &lt;- mean(sample.data)
sample.sd &lt;- sd(sample.data)
std.err &lt;- sample.sd/sqrt(sample.size)
t.stat &lt;- (sample.mean-null.mean)/std.err

t.crit &lt;- abs(qt(0.025,sample.size-1))   # for 2-tailed test

p.val &lt;- (1-pt(abs(t.stat),sample.size-1))*2   # 


### alternatively use the t.test function:

t.test(sample.data,mu=null.mean)   # should get the same answer!</code></pre>
<pre><code>## 
##  One Sample t-test
## 
## data:  sample.data
## t = 3.3424, df = 9, p-value = 0.008628
## alternative hypothesis: true mean is not equal to 10
## 95 percent confidence interval:
##  13.13360 26.25834
## sample estimates:
## mean of x 
##  19.69597</code></pre>
<p>A common version of the one-sample t-test is the ‘paired t-test’, in which a measurement is taken on a single individual before and after a treatment is applied. An example of a paired t-test is the ‘weight loss drug’ example from the ‘basic concepts’ lecture.</p>
</div>
<div id="two-sample-t-test" class="section level3">
<h3>Two-sample t-test</h3>
<p>A two-sample t-test tests the consistency of the sample data with the null hypothesis that sample A was generated from the same underlying population as sample B. The t-statistic in this case is expressed as:</p>
<p><span class="math inline">\(t = \frac{(\bar{x_A}-\bar{x_B})}{s.e._{pooled}}\)</span></p>
<p>Where <span class="math inline">\(\bar{x}\)</span> is the sample mean, <span class="math inline">\(s.e._{pooled}\)</span> is the pooled standard error of the mean across both samples, and <span class="math inline">\(\mu_0\)</span> is the population mean under the null hypothesis.</p>
<p>The t-statistic in the 2-sample case can be interpreted as the difference between the sample mean from population A and the sample mean from population B, in units of (pooled) standard errors.</p>
<p>The formula for the pooled standard error depends on whether your sample size is equal in the two samples and whether you are able to assume that the standard deviation is the same in the two underlying populations.</p>
<p>For the 2-sample t-test, the degrees of freedom is equal to the total sample size across both samples minus 2.</p>
<pre class="r"><code>### two sample t-test 

sample.data.1 &lt;- rnorm(15,55,10)
sample.data.2 &lt;- rnorm(10,45,10)

sample.size.1 &lt;- length(sample.data.1)
sample.size.2 &lt;- length(sample.data.2)
sample.size.pooled &lt;- length(sample.data.1) + length(sample.data.2)

sample.mean1 &lt;- mean(sample.data.1)
sample.mean2 &lt;- mean(sample.data.2)

sample.sd1 &lt;- sd(sample.data.1)
sample.sd2 &lt;- sd(sample.data.2)
sample.sd.pooled &lt;- sqrt(((sample.size.1-1)*sample.sd1^2 + (sample.size.2-1)*sample.sd2^2)/(sample.size.pooled-2))

std.err.pooled &lt;- sample.sd.pooled*sqrt(1/sample.size.1+1/sample.size.2)
t.stat &lt;- (sample.mean1-sample.mean2)/std.err.pooled

t.crit &lt;- abs(qt(0.025,sample.size-1))   # for 2-tailed test

p.val &lt;- (1-pt(abs(t.stat),sample.size.pooled-2))*2   # 



### alternatively use the t.test function:

t.test(sample.data.1,sample.data.2,var.equal = T)   # should get the same answer!</code></pre>
<pre><code>## 
##  Two Sample t-test
## 
## data:  sample.data.1 and sample.data.2
## t = 0.93552, df = 23, p-value = 0.3592
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -4.03479 10.69700
## sample estimates:
## mean of x mean of y 
##  55.40201  52.07090</code></pre>
<p><strong>Q</strong> What are the key assumptions of the 2-sample t-test?</p>
<p><strong>Q</strong> What is the null hypothesis for the 2-sample t-test?</p>
<p>Tails: if one tailed, 95 % of the distribution falls to the left or the right. If two tailed, 95 % of the distribution falls in the middle, with 2.5% of the distribution on each tail.</p>
<p>Paired t-test: calculate differences. Then get the average, SD, SE. DF = differences – 1. Ho: µ=0</p>
<p>t= (x_d ) ̅/〖SE〗_(x ̅d)</p>
<p>Welch’s t-test: Unequal sample sizes, unequal variance. Like a two-sample t-test, but more flexible. Already robust against violations of normality. This is the DEFAULT version of a t-test in R. If you want an actual t-test, you need to tell it to do so! (var.equal = True, sample sizes must also be equal!)</p>
<p>t= ((x_1 ) ̅-(x_2 ) ̅)/√((s_1^2)/n_1 -(s_2^2)/n_2 )</p>
<p>Degrees of freedom is more complicated, and is an approximation:</p>
<p>DF= 〖((s_1^2)/n_1 +(s_2^2)/n_1 )〗<sup>2/(〖((s_1</sup>2)⁄n_1 )〗<sup>2/(n_1-1)+〖((s_2</sup>2)⁄n_2 )〗^2/(n_2-1)) It is usually a decimal number.</p>
<pre class="r"><code>######
# T test examples


#### 
# T-tests
####

#Ttest
# Are my data greater than zero? 
Group0 &lt;- c(0.5, -0.03, 4, 2.5, 0.89, 2.2, 1.7, 1.125)
hist(Group0)
t.test(Group0,alternative=&quot;greater&quot;) # This gets at directionality</code></pre>
<pre><code>## 
##  One Sample t-test
## 
## data:  Group0
## t = 3.5487, df = 7, p-value = 0.00468
## alternative hypothesis: true mean is greater than 0
## 95 percent confidence interval:
##  0.7507388       Inf
## sample estimates:
## mean of x 
##  1.610625</code></pre>
<pre class="r"><code>#Are my data different than zero? 
Group0 &lt;- c(0.5, -0.03, 4, 2.5, 0.89, 2.2, 1.7, 1.125)
hist(Group0)</code></pre>
<p><img src="LECTURE2_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code>t.test(Group0) # Okay, that&#39;s to zero. What about if it&#39;s different than 1? </code></pre>
<pre><code>## 
##  One Sample t-test
## 
## data:  Group0
## t = 3.5487, df = 7, p-value = 0.00936
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  0.5374007 2.6838493
## sample estimates:
## mean of x 
##  1.610625</code></pre>
<pre class="r"><code># are my data different than 1? 
t.test(Group0, mu=1)</code></pre>
<pre><code>## 
##  One Sample t-test
## 
## data:  Group0
## t = 1.3454, df = 7, p-value = 0.2205
## alternative hypothesis: true mean is not equal to 1
## 95 percent confidence interval:
##  0.5374007 2.6838493
## sample estimates:
## mean of x 
##  1.610625</code></pre>
<pre class="r"><code># Now let&#39;s test two groups. 
# are the means equal? 
group1 &lt;- c(7,9,6,6,6,11,6,3,8,7)
group2 &lt;- c(11,13,8,6,14,11,13,13,10,11)
t.test(group1, group2, var.equal=T) # Notice how we set equal variance? Look at the output - &quot;Two Sample t-test.&quot;</code></pre>
<pre><code>## 
##  Two Sample t-test
## 
## data:  group1 and group2
## t = -3.9513, df = 18, p-value = 0.000936
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -6.27997 -1.92003
## sample estimates:
## mean of x mean of y 
##       6.9      11.0</code></pre>
<pre class="r"><code># is this one-tail or two? 

group1 &lt;- c(7,9,6,6,6,11,6,3,8,7)
group2 &lt;- c(11,13,8,6,14,11,13,13,10,11)
t.test(group1, group2) # T value does not change, but DF And p-value do! &quot;Welch Two Sample t-test&quot;</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  group1 and group2
## t = -3.9513, df = 17.573, p-value = 0.0009743
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -6.283771 -1.916229
## sample estimates:
## mean of x mean of y 
##       6.9      11.0</code></pre>
<pre class="r"><code># WELCH IS THE DEFAULT IN R</code></pre>
</div>
</div>
<div id="t-test-sampling-distribution" class="section level2">
<h2>t-test sampling distribution</h2>
</div>
<div id="power-analysis" class="section level2">
<h2>Power analysis</h2>
<p><a href="LECTURE3.html">–go to next lecture–</a></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
